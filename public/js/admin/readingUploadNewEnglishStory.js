function readCoverStory(e){if(img_name_cover=$("input#imgFeature-story[type=file]").val().split("\\").pop(),img_name_cover_no_ext=img_name_cover.split(".")[0],img_name_cover_extension=img_name_cover.substr(img_name_cover.lastIndexOf(".")+1).toLowerCase(),-1==["png","jpg","jpeg","gif"].indexOf(img_name_cover_extension))return bootbox.alert({message:"Img not true format!",backdrop:!0}),$("input#imgFeature-story[type=file]").val(""),$("#image-main-preview-story").attr("src","#"),$("#image-main-preview-story").addClass("hidden-class"),img_name_cover="",void(img_name_cover_no_ext="");if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(e){$("#image-main-preview-story").attr("src",e.target.result).width(150),img_url_cover=e.target.result,$("#image-main-preview-story").removeClass("hidden-class")},a.readAsDataURL(e.files[0])}}function readAuthorAvatar(e){if(img_name_author=$("input#imgFeature-author[type=file]").val().split("\\").pop(),img_name_author_no_ext=img_name_author.split(".")[0],img_name_author_extension=img_name_author.substr(img_name_author.lastIndexOf(".")+1).toLowerCase(),-1==["png","jpg","jpeg","gif"].indexOf(img_name_author_extension))return bootbox.alert({message:"Img not true format!",backdrop:!0}),$("input#imgFeature-author[type=file]").val(""),$("#image-main-preview-author").attr("src","#"),$("#image-main-preview-author").addClass("hidden-class"),img_name_author="",void(img_name_author_no_ext="");if(e.files&&e.files[0]){var a=new FileReader;a.onload=function(e){$("#image-main-preview-author").attr("src",e.target.result).width(150),img_url_author=e.target.result,$("#image-main-preview-author").removeClass("hidden-class")},a.readAsDataURL(e.files[0])}}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('[name="_token"]').val()}});var img_url_author="",img_url_cover="",img_name_cover="",img_name_cover_no_ext="",img_name_cover_extension="",img_name_author="",img_name_author_no_ext="",img_name_author_extension="",baseUrl=document.location.origin,mainUrl=baseUrl.substring(13),ajaxFinishCreateNewStory=baseUrl+"/createNewStory",ajaxFinishCreateNewChapterOfStory=baseUrl+"/createNewChapterOfStory";$(".btn-finish-new-story").click(function(){var e=$("#new_title_story").val().trim(),a=$("#name_author").val().trim(),t=$("#level_story").val().trim(),r=$("#genre_story").val().trim(),o=$("#length_story").val().trim();""==a||""==e||""==img_url_cover||""==img_url_author||""==t||""==r||""==o?bootbox.alert({message:"Please enter data!",backdrop:!0}):($("#loading").show(),$.ajax({type:"POST",url:ajaxFinishCreateNewStory,dataType:"json",data:{name_author:a,level_story:t,genre_story:r,length_story:o,img_url_cover:img_url_cover,img_name_cover:img_name_cover,img_name_cover_no_ext:img_name_cover_no_ext,img_name_cover_extension:img_name_cover_extension,img_url_author:img_url_author,img_name_author:img_name_author,img_name_author_no_ext:img_name_author_no_ext,img_name_author_extension:img_name_author_extension,new_title_story:e},success:function(a){$("#loading").hide(),bootbox.alert({message:"Create new type story success!",backdrop:!0,callback:function(){$("#list_stories").append('<option selected value="'+a.story_id+'">'+e+"</option>"),$("#new_title_story").val(""),$("#imgFeature").val(""),img_name="",$("#image-main-preview").attr("src","#"),$("#image-main-preview").addClass("hidden-class"),$("#readingCreateNewStory").modal("toggle")}})},error:function(e){$("#loading").hide(),bootbox.alert({message:"FAIL CREATE NEW TYPE STORY!",backdrop:!0})}}))}),$(".btn-create-new-chapter-of-story").click(function(){var e=$("#title_chapter").val().trim(),a=$("#order_chapter").val().trim(),t=$("#number_images_chapter").val().trim(),r=$("#list_stories").val().trim(),o=CKEDITOR.instances.content_chapter.getData().trim();""==r||""==e||""==a||""==t||""==o?bootbox.alert({message:"Please enter data!",backdrop:!0}):($("#loading").show(),$.ajax({type:"POST",url:ajaxFinishCreateNewChapterOfStory,dataType:"json",data:{story_id:r,title_chapter:e,order_chapter:a,number_images_chapter:t,content_chapter:o},success:function(e){$("#loading").hide(),"success"==e.result?bootbox.alert({message:"Create new chapter of story success!",backdrop:!0,callback:function(){location.href=baseUrl+"/uploadReadingStory"}}):bootbox.alert({message:"Order Chapter Wrong!",backdrop:!0})},error:function(e){$("#loading").hide(),bootbox.alert({message:"FAIL CREATE NEW CHAPTER OF STORY!",backdrop:!0})}}))});